var fs = require('fs');
var path = require('path');
var jwt = require('../index');
var JsonWebTokenError = require('../lib/JsonWebTokenError');
var expect = require('chai').expect;


var pub = fs.readFileSync(path.join(__dirname, 'pub.pem'), 'utf8');
// priv is never used
// var priv = fs.readFileSync(path.join(__dirname, 'priv.pem'));

var TOKEN = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJmb28iOiJiYXIiLCJpYXQiOjE0MjY1NDY5MTl9.ETgkTn8BaxIX4YqvUWVFPmum3moNZ7oARZtSBXb_vP4';

describe('when setting a wrong `header.alg`', function () ***REMOVED***

  describe('signing with pub key as symmetric', function () ***REMOVED***
    it('should not verify', function () ***REMOVED***
      expect(function () ***REMOVED***
        jwt.verify(TOKEN, pub);
      ***REMOVED***).to.throw(JsonWebTokenError, /invalid algorithm/);
    ***REMOVED***);
  ***REMOVED***);

  describe('signing with pub key as HS256 and whitelisting only RS256', function () ***REMOVED***
    it('should not verify', function () ***REMOVED***
      expect(function () ***REMOVED***
        jwt.verify(TOKEN, pub, ***REMOVED***algorithms: ['RS256']***REMOVED***);
      ***REMOVED***).to.throw(JsonWebTokenError, /invalid algorithm/);
    ***REMOVED***);
  ***REMOVED***);

  describe('signing with HS256 and checking with HS384', function () ***REMOVED***
    it('should not verify', function () ***REMOVED***
      expect(function () ***REMOVED***
        var token = jwt.sign(***REMOVED***foo: 'bar'***REMOVED***, 'secret', ***REMOVED***algorithm: 'HS256'***REMOVED***);
        jwt.verify(token, 'some secret', ***REMOVED***algorithms: ['HS384']***REMOVED***);
      ***REMOVED***).to.throw(JsonWebTokenError, /invalid algorithm/);
    ***REMOVED***);
  ***REMOVED***);


***REMOVED***);
